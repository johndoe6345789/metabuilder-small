entity: UIPage
version: "1.0"
description: "Declarative JSON-based UI page definitions"

fields:
  id:
    type: uuid
    primary: true
    generated: true

  path:
    type: string
    required: true
    max_length: 500
    description: "URL path for this page (e.g., /login, /dashboard)"

  title:
    type: string
    required: true
    max_length: 255

  level:
    type: integer
    required: true
    min: 1
    max: 6
    description: "Navigation level (1-6)"

  requireAuth:
    type: boolean
    required: true
    default: false

  requiredRole:
    type: string
    optional: true
    nullable: true
    max_length: 50
    description: "Required role to access (user, moderator, admin, god, supergod)"

  layout:
    type: string
    required: true
    description: "Component tree definition (type, props, children)"

  actions:
    type: string
    optional: true
    nullable: true
    description: "Action handlers (script function references)"

  packageId:
    type: string
    optional: true
    nullable: true
    description: "Package this page belongs to"

  isActive:
    type: boolean
    required: true
    default: true
    description: "Whether this page is currently active/published"

  createdAt:
    type: bigint
    optional: true
    nullable: true

  updatedAt:
    type: bigint
    optional: true
    nullable: true

  createdBy:
    type: uuid
    optional: true
    nullable: true
    foreign_key:
      entity: User
      field: id

indexes:
  - fields: [path]
    unique: true
  - fields: [level, isActive]
  - fields: [packageId]

relations:
  package:
    type: belongs-to
    entity: InstalledPackage
    foreign_key: packageId
    nullable: true
    on_delete: cascade
    description: "Package this page belongs to"

  creator:
    type: belongs-to
    entity: User
    foreign_key: createdBy
    nullable: true
    on_delete: set_null
    description: "User who created this page"

acl:
  create:
    role: [admin, god, supergod]
  read:
    public: true
  update:
    role: [admin, god, supergod]
  delete:
    role: [god, supergod]
