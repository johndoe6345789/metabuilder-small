entity: User
version: "1.0"
description: "User account entity with authentication and role management"

fields:
  id:
    type: uuid
    primary: true
    generated: true
    description: "Unique user identifier"

  username:
    type: string
    required: true
    unique: true
    min_length: 3
    max_length: 50
    pattern: "^[a-zA-Z0-9_-]+$"
    description: "Unique username for login"

  email:
    type: email
    required: true
    unique: true
    max_length: 255
    description: "User email address"

  role:
    type: enum
    required: true
    values: [public, user, moderator, admin, god, supergod]
    default: user
    description: "User role defining access level"

  profilePicture:
    type: string
    optional: true
    nullable: true
    description: "Profile avatar URL"

  bio:
    type: text
    optional: true
    nullable: true
    description: "Short user bio"

  createdAt:
    type: bigint
    optional: true
    nullable: true
    description: "Account creation timestamp"

  tenantId:
    type: string
    optional: true
    nullable: true

  isInstanceOwner:
    type: boolean
    optional: true
    nullable: true
    default: false

  passwordChangeTimestamp:
    type: bigint
    optional: true
    nullable: true

  firstLogin:
    type: boolean
    optional: true
    nullable: true
    default: false

indexes:
  - fields: [username]
    unique: true
  - fields: [email]
    unique: true
  - fields: [role]
  - fields: [tenantId]

relations:
  sessions:
    type: has-many
    entity: Session
    foreign_key: userId
    cascade_delete: true
    description: "Active sessions for this user"

  workflows:
    type: has-many
    entity: Workflow
    foreign_key: createdBy
    cascade_delete: false
    description: "Workflows created by this user"

  pages:
    type: has-many
    entity: UIPage
    foreign_key: createdBy
    cascade_delete: false
    description: "UI pages created by this user"

acl:
  create:
    public: true
  read:
    self: true
    admin: true
  update:
    self: true
    admin: true
  delete:
    admin: true
