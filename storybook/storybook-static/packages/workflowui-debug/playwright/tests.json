{
  "$schema": "https://metabuilder.dev/schemas/package-playwright.schema.json",
  "package": "workflowui-debug",
  "version": "1.0.0",
  "description": "WorkflowUI Debug tests - inspect and analyze pages with screenshots and JS",
  "tests": [
    {
      "name": "inspect dashboard page structure",
      "tags": ["@debug", "@inspect"],
      "timeout": 15000,
      "steps": [
        {
          "description": "Navigate to dashboard",
          "action": "navigate",
          "url": "/"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "description": "Take full page screenshot",
          "action": "debugScreenshot",
          "filename": "dashboard-full.png",
          "fullPage": true
        },
        {
          "description": "Get page structure",
          "action": "inspectPageStructure"
        },
        {
          "description": "Get all text on page",
          "action": "getAllText"
        },
        {
          "description": "Find Workspaces text",
          "action": "findByText",
          "text": "Workspaces"
        }
      ]
    },
    {
      "name": "inspect editor page and find ReactFlow",
      "tags": ["@debug", "@editor"],
      "timeout": 15000,
      "steps": [
        {
          "action": "navigate",
          "url": "/editor/test-workflow-001"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "action": "wait",
          "timeout": 2000
        },
        {
          "description": "Screenshot editor",
          "action": "debugScreenshot",
          "filename": "editor-page.png"
        },
        {
          "description": "Look for ReactFlow elements",
          "action": "findByText",
          "text": "react-flow"
        },
        {
          "description": "Inspect page structure",
          "action": "inspectPageStructure"
        }
      ]
    },
    {
      "name": "debug failing element search with retry",
      "tags": ["@debug", "@retry"],
      "timeout": 20000,
      "steps": [
        {
          "action": "navigate",
          "url": "/workflows"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "description": "Try to find filter with smart wait",
          "action": "waitForElement",
          "selector": "select, button:has-text('Status'), button:has-text('Filter')",
          "timeout": 5000,
          "state": "visible"
        }
      ]
    },
    {
      "name": "inspect specific element details",
      "tags": ["@debug", "@inspect"],
      "timeout": 15000,
      "steps": [
        {
          "action": "navigate",
          "url": "/"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "description": "Inspect New Workspace button",
          "action": "retry",
          "maxAttempts": 3,
          "delay": 1000,
          "steps": [
            {
              "action": "inspectElement",
              "selector": "button:has-text('New Workspace')"
            }
          ]
        },
        {
          "description": "Get computed styles",
          "action": "getComputedStyle",
          "selector": "button:has-text('New Workspace')",
          "property": "background-color"
        }
      ]
    },
    {
      "name": "find all buttons on page",
      "tags": ["@debug", "@discovery"],
      "timeout": 15000,
      "steps": [
        {
          "action": "navigate",
          "url": "/"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "description": "Find button text",
          "action": "findByText",
          "text": "button"
        },
        {
          "description": "Screenshot with buttons highlighted",
          "action": "debugScreenshot",
          "filename": "dashboard-buttons.png"
        }
      ]
    },
    {
      "name": "analyze plugins page for missing elements",
      "tags": ["@debug", "@plugins"],
      "timeout": 15000,
      "steps": [
        {
          "action": "navigate",
          "url": "/plugins"
        },
        {
          "action": "waitForLoadState",
          "state": "domcontentloaded"
        },
        {
          "action": "wait",
          "timeout": 2000
        },
        {
          "description": "Screenshot plugins page",
          "action": "debugScreenshot",
          "filename": "plugins-page.png"
        },
        {
          "description": "Find Core category",
          "action": "findByText",
          "text": "Core"
        },
        {
          "description": "Look for search input",
          "action": "waitForElement",
          "selector": "input[type='search'], input[placeholder*='search' i]",
          "timeout": 3000
        },
        {
          "description": "Get page structure",
          "action": "inspectPageStructure"
        }
      ]
    },
    {
      "name": "retry flaky test with screenshots",
      "tags": ["@debug", "@retry"],
      "timeout": 30000,
      "steps": [
        {
          "action": "navigate",
          "url": "/workflows"
        },
        {
          "description": "Retry search with auto-screenshot on failure",
          "action": "retry",
          "maxAttempts": 3,
          "delay": 2000,
          "steps": [
            {
              "action": "waitForLoadState",
              "state": "domcontentloaded"
            },
            {
              "action": "debugScreenshot",
              "filename": "workflows-retry.png"
            },
            {
              "action": "waitForElement",
              "selector": "input[placeholder*='Search']",
              "timeout": 5000
            }
          ]
        }
      ]
    }
  ]
}
