============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
rootdir: /workspace/dbal/production/tests/integration
collecting ... collected 17 items

test_api_endpoints.py::TestHealthEndpoints::test_health_endpoint_returns_200 PASSED [  5%]
test_api_endpoints.py::TestHealthEndpoints::test_health_endpoint_json_format PASSED [ 11%]
test_api_endpoints.py::TestHealthEndpoints::test_version_endpoint_returns_200 PASSED [ 17%]
test_api_endpoints.py::TestHealthEndpoints::test_version_endpoint_json_format PASSED [ 23%]
test_api_endpoints.py::TestHealthEndpoints::test_status_endpoint_returns_200 PASSED [ 29%]
test_api_endpoints.py::TestHealthEndpoints::test_status_endpoint_has_server_info PASSED [ 35%]
test_api_endpoints.py::TestEntityEndpoints::test_list_users_endpoint FAILED [ 41%]
test_api_endpoints.py::TestEntityEndpoints::test_create_user_endpoint FAILED [ 47%]
test_api_endpoints.py::TestEntityEndpoints::test_invalid_tenant_returns_error FAILED [ 52%]
test_api_endpoints.py::TestEntityEndpoints::test_invalid_entity_returns_error FAILED [ 58%]
test_api_endpoints.py::TestConcurrency::test_concurrent_health_checks FAILED [ 64%]
test_api_endpoints.py::TestConcurrency::test_concurrent_status_checks FAILED [ 70%]
test_api_endpoints.py::TestErrorHandling::test_404_on_unknown_endpoint FAILED [ 76%]
test_api_endpoints.py::TestErrorHandling::test_invalid_json_in_post FAILED [ 82%]
test_api_endpoints.py::TestErrorHandling::test_options_request_handling FAILED [ 88%]
test_api_endpoints.py::TestResponseHeaders::test_content_type_json FAILED [ 94%]
test_api_endpoints.py::TestResponseHeaders::test_response_has_server_header FAILED [100%]

=================================== FAILURES ===================================
E   http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:
E   urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:659: requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /invalid_tenant/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /invalid_tenant/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /invalid_tenant/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/InvalidEntity (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/InvalidEntity (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/InvalidEntity (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /status (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /status (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /status (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /unknown/endpoint/path (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /unknown/endpoint/path (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /unknown/endpoint/path (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /acme/admin/User (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
E   ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
/usr/local/lib/python3.10/dist-packages/requests/adapters.py:677: requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='localhost', port=8080): Failed to establish a new connection: [Errno 111] Connection refused"))
=========================== short test summary info ============================
FAILED test_api_endpoints.py::TestEntityEndpoints::test_list_users_endpoint
FAILED test_api_endpoints.py::TestEntityEndpoints::test_create_user_endpoint
FAILED test_api_endpoints.py::TestEntityEndpoints::test_invalid_tenant_returns_error
FAILED test_api_endpoints.py::TestEntityEndpoints::test_invalid_entity_returns_error
FAILED test_api_endpoints.py::TestConcurrency::test_concurrent_health_checks
FAILED test_api_endpoints.py::TestConcurrency::test_concurrent_status_checks
FAILED test_api_endpoints.py::TestErrorHandling::test_404_on_unknown_endpoint
FAILED test_api_endpoints.py::TestErrorHandling::test_invalid_json_in_post - ...
FAILED test_api_endpoints.py::TestErrorHandling::test_options_request_handling
FAILED test_api_endpoints.py::TestResponseHeaders::test_content_type_json - r...
FAILED test_api_endpoints.py::TestResponseHeaders::test_response_has_server_header
========================= 11 failed, 6 passed in 0.08s =========================
⚙️  Executing in dev: cat /tmp/final-test-results.txt
