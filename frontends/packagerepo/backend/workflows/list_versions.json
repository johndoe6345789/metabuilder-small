{
  "name": "List Package Versions",
  "active": false,
  "nodes": [
    {
      "id": "parse_path",
      "name": "Parse Path",
      "type": "packagerepo.parse_path",
      "typeVersion": 1,
      "position": [
        100,
        100
      ],
      "parameters": {
        "path": "$request.path",
        "pattern": "/v1/:namespace/:name/versions",
        "out": "entity"
      }
    },
    {
      "id": "normalize",
      "name": "Normalize",
      "type": "packagerepo.normalize_entity",
      "typeVersion": 1,
      "position": [
        400,
        100
      ],
      "parameters": {
        "entity": "$entity",
        "out": "normalized"
      }
    },
    {
      "id": "query_index",
      "name": "Query Index",
      "type": "packagerepo.index_query",
      "typeVersion": 1,
      "position": [
        700,
        100
      ],
      "parameters": {
        "key": "$entity.namespace/$entity.name",
        "out": "versions"
      }
    },
    {
      "id": "check_exists",
      "name": "Check Exists",
      "type": "logic.if",
      "typeVersion": 1,
      "position": [
        100,
        300
      ],
      "parameters": {
        "condition": "$versions == null",
        "then": "error_not_found",
        "else": "enrich_versions"
      }
    },
    {
      "id": "enrich_versions",
      "name": "$entity.name",
      "type": "packagerepo.enrich_version_list",
      "typeVersion": 1,
      "position": [
        400,
        300
      ],
      "parameters": {
        "namespace": "$entity.namespace",
        "versions": "$versions",
        "out": "enriched"
      }
    },
    {
      "id": "respond_json",
      "name": "Respond Json",
      "type": "packagerepo.respond_json",
      "typeVersion": 1,
      "position": [
        700,
        300
      ],
      "parameters": {
        "body": {
          "namespace": "$entity.namespace",
          "name": "$entity.name",
          "versions": "$enriched"
        },
        "status": 200
      }
    },
    {
      "id": "error_not_found",
      "name": "Error Not Found",
      "type": "packagerepo.respond_error",
      "typeVersion": 1,
      "position": [
        100,
        500
      ],
      "parameters": {
        "message": "Package not found",
        "status": 404
      }
    }
  ],
  "connections": {
    "parse_path": {
      "main": [
        [
          {
            "node": "normalize",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "normalize": {
      "main": [
        [
          {
            "node": "query_index",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "query_index": {
      "main": [
        [
          {
            "node": "check_exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "check_exists": {
      "main": [
        [
          {
            "node": "enrich_versions",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "enrich_versions": {
      "main": [
        [
          {
            "node": "respond_json",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "respond_json": {
      "main": [
        [
          {
            "node": "error_not_found",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "staticData": {},
  "meta": {},
  "settings": {
    "timezone": "UTC",
    "executionTimeout": 3600,
    "saveExecutionProgress": true,
    "saveDataErrorExecution": "all",
    "saveDataSuccessExecution": "all"
  },
  "id": "workflow_list_versions",
  "version": "3.0.0",
  "tenantId": "${TENANT_ID}"
}